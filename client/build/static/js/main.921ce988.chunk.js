(this.webpackJsonpuvid=this.webpackJsonpuvid||[]).push([[0],{118:function(e,n){},125:function(e,n,t){"use strict";t.r(n);var o,a=t(0),i=t.n(a),r=t(56),c=t.n(r),s=t(8),u=t(9),d=t(11),l=t(10),f=(t(66),t(58)),v=t(12),h=function(e){Object(d.a)(t,e);var n=Object(l.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(u.a)(t,[{key:"render",value:function(){var e=this;return i.a.createElement("div",null,"JA LETS GO",i.a.createElement("hr",null),i.a.createElement("button",{onClick:function(){return e.props.history.push("/videochat")}},"Videochat"))}}]),t}(a.Component),p=t(23),m=t.n(p),g=function(e){Object(d.a)(t,e);var n=Object(l.a)(t);function t(e){var a;return Object(s.a)(this,t),a=n.call(this,e),o=a.props.socket,a.state={ownPeer:"",peers:[]},o.on("connectToPeer",(function(e){a.updatePeer(),navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!0}).then((function(n){var t=document.createElement("video"),a=new m.a({initiator:!1,trickle:!1,stream:n});a.signal(JSON.parse(e.peer)),a.on("signal",(function(n){n.renegotiate||(n=JSON.stringify(n),o.emit("finalHandshake",{peer:n,index:e.index,socket:e.socket}))})),a.on("stream",(function(e){document.querySelector("#videos").appendChild(t),t.srcObject=e,t.onloadedmetadata=function(e){t.play()}})),a.on("close",(function(){t.remove()}))}))})),o.on("finalHandshake",(function(e){var n=a.state.peers[e.index];n.signal(JSON.parse(e.peer)),n.on("stream",(function(e){var n=document.createElement("video");document.querySelector("#videos").appendChild(n),n.srcObject=e,n.onloadedmetadata=function(e){n.play()}})),a.updatePeer()})),a}return Object(u.a)(t,[{key:"componentDidMount",value:function(){var e=this;navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!1}).then((function(e){var n=document.querySelector("#ownVideo");n.srcObject=e,n.play()})),o.emit("addUser",{},(function(){e.getAllUsers()}))}},{key:"startPeer",value:function(){}},{key:"getAllUsers",value:function(){var e=this;o.emit("getAllUsers",(function(n){navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!0}).then((function(t){n.users.forEach((function(n){if(n.socketId!==o.id){var a=new m.a({initiator:!0,trickle:!1,stream:t});e.addPeerToPeers(a).then((function(t){e.state.peers[t].on("signal",(function(a){var i=JSON.stringify(a);e.setState({ownPeer:i}),o.emit("connectToPeer",{peer:i,index:t,socket:n.socketId})}))}))}}))})),1===n.users.length&&e.updatePeer()}))}},{key:"addPeerToPeers",value:function(e){var n=this;return new Promise((function(t){var o=n.state.peers;o.push(e),n.setState({peers:o},(function(){t(o.length-1)}))}))}},{key:"updatePeer",value:function(){var e=this;this.setState({ownPeer:"Loading.."}),navigator.mediaDevices.getUserMedia({video:{facingMode:"environment"},audio:!0}).then((function(n){var t=new m.a({initiator:!0,trickle:!1,stream:n});e.addPeerToPeers(t).then((function(n){e.state.peers[n].on("signal",(function(t){t=JSON.stringify(t),e.setState({ownPeer:t}),o.emit("updateUser",{peer:t,index:n})}))}))}))}},{key:"render",value:function(){return i.a.createElement("div",null,"ownPeer: ",this.state.ownPeer?i.a.createElement("textarea",{value:this.state.ownPeer,disabled:!0}):"Loading..",i.a.createElement("div",{id:"videos"},i.a.createElement("video",{id:"ownVideo"})))}}]),t}(a.Component),w=t(57),k=t.n(w)()("https://".concat(window.location.hostname),{secure:!0}),b=function(e){Object(d.a)(t,e);var n=Object(l.a)(t);function t(){return Object(s.a)(this,t),n.apply(this,arguments)}return Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement(f.a,null,i.a.createElement(v.c,null,i.a.createElement(v.a,{exact:!0,path:"/",component:h}),i.a.createElement(v.a,{exact:!0,path:"/videochat",component:function(){return i.a.createElement(g,{socket:k})}})))}}]),t}(a.Component),y=function(e){Object(d.a)(t,e);var n=Object(l.a)(t);function t(e){var o;return Object(s.a)(this,t),(o=n.call(this,e)).state={},o}return Object(u.a)(t,[{key:"render",value:function(){return i.a.createElement(b,null)}}]),t}(a.Component),O=Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));function j(e){navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var n=e.installing;n.onstatechange=function(){"installed"===n.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}c.a.render(i.a.createElement(y,null),document.getElementById("root")),function(){if("serviceWorker"in navigator){if(new URL("",window.location).origin!==window.location.origin)return;window.addEventListener("load",(function(){var e="".concat("","/service-worker.js");O?(!function(e){fetch(e).then((function(n){404===n.status||-1===n.headers.get("content-type").indexOf("javascript")?navigator.serviceWorker.ready.then((function(e){e.unregister().then((function(){window.location.reload()}))})):j(e)})).catch((function(){console.log("No internet connection found. App is running in offline mode.")}))}(e),navigator.serviceWorker.ready.then((function(){console.log("This web app is being served cache-first by a service worker. To learn more, visit https://goo.gl/SC7cgQ")}))):j(e)}))}}()},61:function(e,n,t){e.exports=t(125)},66:function(e,n,t){},90:function(e,n){},92:function(e,n){}},[[61,1,2]]]);
//# sourceMappingURL=main.921ce988.chunk.js.map